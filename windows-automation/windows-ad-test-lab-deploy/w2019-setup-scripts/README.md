# w2019-setup-scripts
# Порядок действий
Создаём ВМ из шаблона: w2019c-template-aratner (или любым другим способом)
Увеличиваем диск ВМ
Включаем ВМ
### Скрипты лежат в C:\\_script
Часть скриптов продублирована в шаблоне ВМ в папке C:\\_script
## На консоле в ВМ вывполняем скрипты
### setup_ip_static.ps1
Установим адрес статически, такой же как получили от DHCP сервера. На DHCP надо включить резервирование этого адреса.
### setup_ip_dhcp.ps1
Или настроим получение адреса автоматически, от DHCP сервера
### setup_sshd.ps1
Настраиваем SSH сервер
Устанавливаем. Добавляем ключи. Добавляем опции в sshd_config
## Остальное можно удалённо по SSH или RDP
### setup_pstab.ps1
Сделать реакцию powershell на ТАБ как в bash
### setup_firewall.ps1
Разрешаем входящие ICMP и SMB
### resizepart.ps1
Увиличиваем раздел 1, диска 0, до максимально вомзожного размера
### setup_choco.ps1
Ставим пакетный менеджер (в два приёма, запускаем, установятся зависимости, перезагружаемся, ещё раз запускаем и ещё раз перезагружаемся)
### setup_git.bat
Необходим пакетный менеджер Choco. Скрипт установит git, vim, far manager.

## Копируем репозиторий со скриптами из git
```
mkdir c:\git
cd c:\git
git clone https://gitlab.croc.ru/croc_dit/GR_sys_ing/windows-ad-test-lab-deploy
cd C:\git\windows-ad-test-lab-deploy\w2019-setup-scripts
```
## настроим AD 
### vim setup_variables.ps1
исправим переменные перед запуском. Переменные из этого файла используются остальными скриптами.
### setup_hostname.ps1
установить имя компьютера
### setup_AD_add_dc.ps1
добавить контроллер в существующий домен.
### setup_AD_add_domain.ps1
добавить новый домен в существующий лес
### setup_AD_add_forrest.ps1
Создать новый лес
### setup_AD_join.ps1
подключить комп к домену
### setup_AD_leave.ps1
вывести комп из домена
### setup_AD_rejoin.ps1
переподключиться к домену
### setup_share.ps1
Создаст папку C:\pub и расшарит её
