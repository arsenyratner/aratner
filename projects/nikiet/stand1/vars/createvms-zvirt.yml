createvm_default:
  clone: true
  cluster: CL-OVN
  disksize: 32GiB
  disk_format: "raw"
  dns_search: msk1.nikiet.ru
  dns_servers: "172.28.212.11 172.28.212.12"
  memory: 2GiB
  nic:
    name: eth0
    network: aratner-212
    profile_name: aratner-212
  nic_boot_protocol: dhcp
  template: tmp-alse-1.7.6uu2-max
  template_version: 0
  timezone: Europe/Moscow
  startvm: false
  waitstart: false
  username: "{{ ansible_user }}"
  userpass: "{{ ansible_password }}"
  pubkey: "{{ ansible_ssh_public_key }}"
  customscript: |
    write_files:
    - path: /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg
      content: |
        network: {config: disabled}
      permissions: '0644'
      owner: root:root
    - path: /etc/issue
      append: true
      content: |
        \4
        \6
    - path: /root/cloudinit-disable.sh
      content: |
        #!/bin/bash
        mv /etc/netplan/50-cloud-init.yaml /etc/netplan/01-static.yaml
        systemctl disable cloud-config.service cloud-final.service cloud-init.service cloud-init-local.service
        touch /root/cloudinit-disable.done
        echo "disabled by cloudinit custom script" > /etc/cloud/cloud-init.disabled
      permissions: '0644'
      owner: root:root
    runcmd:
    - [sh, /root/cloudinit-disable.sh]

newvms:
# - { project: nikietstand1, site: msk1, role: dc, suffix: 1, cpu_cores: 8, memory: 16GiB, disk1size: 50GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.11, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: msk1, role: dc, suffix: 2, cpu_cores: 8, memory: 16GiB, disk1size: 50GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.12, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: msk1, role: dhcp, suffix: 1, cpu_cores: 2, memory: 2GiB, disk1size: 30GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.13, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: msk1, role: repo, suffix: 1, cpu_cores: 2, memory: 2GiB, disk1size: 100GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.14, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: msk1, role: pxe, suffix: 1, cpu_cores: 2, memory: 2GiB, disk1size: 30GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.15, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: msk1, role: mon, suffix: 1, cpu_cores: 2, memory: 2GiB, disk1size: 30GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.16, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: msk1, role: audit, suffix: 1, cpu_cores: 2, memory: 2GiB, disk1size: 30GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.17, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: msk1, role: ps, suffix: 1, cpu_cores: 2, memory: 2GiB, disk1size: 30GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.18, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: msk1, role: fs, suffix: 1, cpu_cores: 2, memory: 2GiB, disk1size: 30GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.19, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: dmz, role: apt, suffix: 1, cpu_cores: 2, memory: 2GiB, disk1size: 100GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.20, netmask: 255.255.255.0, gateway: 172.28.212.1, }}
- { project: nikietstand1, site: msk1, role: ws, suffix: 1, cpu_cores: 4, memory: 8GiB, disk1size: 100GiB, disk1_domain: fc_dc_ovn_01, disk_format: cow, ipv4: { method: static, address: 172.28.212.51, netmask: 255.255.255.0, gateway: 172.28.212.1, }}